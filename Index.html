<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mickey X Web - Dynamic Psychology Predictor</title>
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
        import { getDatabase, ref, push, onValue, set, get, child, remove, query, orderByChild } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";
        
        const firebaseConfig = {
            apiKey: "AIzaSyCShaI7FfDCvZ9t21RdBk7ATjk5PQUAeQI",
            authDomain: "wingo-predictor-hub.firebaseapp.com",
            databaseURL: "https://wingo-predictor-hub-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "wingo-predictor-hub",
            storageBucket: "wingo-predictor-hub.firebasestorage.app",
            messagingSenderId: "510934626240",
            appId: "1:510934626240:web:8df9c4b4a78964f15d2225",
            measurementId: "G-TTM7WXC4DW"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        
        window.firebaseDatabase = database;
        window.firebaseRef = ref;
        window.firebasePush = push;
        window.firebaseOnValue = onValue;
        window.firebaseSet = set;
        window.firebaseGet = get;
        window.firebaseChild = child;
        window.firebaseRemove = remove;
        window.firebaseQuery = query;
        window.firebaseOrderByChild = orderByChild;
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Particles Background */
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
        }

        /* All Pages */
        #landing-page, #video-page, #access-key-page, #prediction-page {
            display: none;
        }

        #landing-page {
            display: block;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 30px 20px 20px;
            background: linear-gradient(180deg, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.7) 100%);
            border-bottom: 3px solid #ff3366;
            box-shadow: 0 5px 20px rgba(255, 51, 102, 0.3);
            position: relative;
        }

        .header h1 {
            font-size: 3rem;
            background: linear-gradient(90deg, #ff3366, #ff9966, #ff3366);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(255, 51, 102, 0.5);
            letter-spacing: 2px;
            font-weight: bold;
        }

        .header p {
            color: #ccc;
            font-size: 1.2rem;
            letter-spacing: 1px;
        }

        /* Online Users */
        .online-users {
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(90deg, #00ff88, #00ccff);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.5);
        }

        .online-users i {
            font-size: 1.2rem;
        }

        /* Platform Selection */
        .platform-section {
            padding: 30px 20px;
            text-align: center;
        }

        .platform-section h2 {
            font-size: 2.5rem;
            margin-bottom: 40px;
            color: #00ffcc;
            text-shadow: 0 0 15px rgba(0, 255, 204, 0.5);
            letter-spacing: 3px;
            background: linear-gradient(90deg, #00ffcc, #00ff88);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        /* Horizontal Scroll Container */
        .platform-container {
            display: flex;
            overflow-x: auto;
            gap: 25px;
            padding: 25px 20px;
            scroll-snap-type: x mandatory;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .platform-container::-webkit-scrollbar {
            display: none;
        }

        /* Phone-shaped Platform Boxes */
        .platform-box {
            flex: 0 0 auto;
            width: 300px;
            height: 550px;
            background: linear-gradient(145deg, #1e1e1e, #2a2a2a);
            border-radius: 40px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.4s ease;
            border: 3px solid #444;
            scroll-snap-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            padding: 20px;
            padding-top: 35px;
        }

        .platform-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 180px;
            height: 25px;
            background: #111;
            border-radius: 0 0 15px 15px;
            z-index: 2;
        }

        .platform-box::after {
            content: '';
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 6px;
            background: #333;
            border-radius: 3px;
            z-index: 3;
        }

        .platform-box:hover {
            transform: translateY(-15px) scale(1.03);
            border-color: #ff3366;
            box-shadow: 0 20px 40px rgba(255, 51, 102, 0.4);
            background: linear-gradient(145deg, #2a2a2a, #333);
        }

        .platform-image-container {
            width: 100%;
            height: 400px;
            border-radius: 30px;
            overflow: hidden;
            position: relative;
            border: 2px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
            background: rgba(0, 0, 0, 0.3);
        }

        .platform-image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.3s ease;
        }

        .platform-box:hover .platform-image-container img {
            transform: scale(1.05);
            border-color: #ff3366;
            box-shadow: 0 0 30px rgba(255, 51, 102, 0.5);
        }

        .platform-box .platform-name {
            font-size: 1.8rem;
            font-weight: bold;
            color: white;
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            background: linear-gradient(90deg, #fff, #ccc);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            padding: 10px 20px;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .select-btn {
            position: absolute;
            bottom: 20px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #ff3366, #ff6699);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            color: white;
            box-shadow: 0 5px 15px rgba(255, 51, 102, 0.4);
            transition: all 0.3s ease;
            z-index: 2;
        }

        .platform-box:hover .select-btn {
            transform: scale(1.2);
            box-shadow: 0 0 20px rgba(255, 51, 102, 0.8);
        }

        /* Video Page */
        #video-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 1000;
        }

        .video-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #introVideo {
            width: 100%;
            height: 100%;
            object-fit: contain;
            background: #000;
        }

        #sorryVideo {
            width: 100%;
            height: 100%;
            object-fit: contain;
            background: #000;
        }

        .skip-btn {
            position: absolute;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(90deg, #ff3366, #ff6699);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            z-index: 1001;
            box-shadow: 0 5px 15px rgba(255, 51, 102, 0.4);
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .skip-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(255, 51, 102, 0.6);
        }

        .video-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 30px;
            border-radius: 15px;
            border: 3px solid #ff3366;
            text-align: center;
            max-width: 600px;
            z-index: 1002;
        }

        .video-message h2 {
            color: #ff3366;
            margin-bottom: 15px;
            font-size: 2rem;
        }

        .video-message p {
            color: #fff;
            font-size: 1.2rem;
            line-height: 1.6;
        }

        /* Access Key Page */
        #access-key-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            z-index: 900;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .access-key-container {
            background: rgba(30, 30, 30, 0.95);
            border-radius: 20px;
            padding: 40px;
            border: 3px solid #444;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            max-width: 500px;
            width: 90%;
            text-align: center;
        }

        .access-key-container h2 {
            color: #00ccff;
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-shadow: 0 0 15px rgba(0, 204, 255, 0.5);
        }

        .access-key-container p {
            color: #aaa;
            margin-bottom: 30px;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .key-input-group {
            margin-bottom: 25px;
        }

        .key-input-group input {
            width: 100%;
            padding: 15px 20px;
            border-radius: 10px;
            border: 2px solid #444;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 1.2rem;
            text-align: center;
            letter-spacing: 3px;
        }

        .key-input-group input:focus {
            outline: none;
            border-color: #00ccff;
            box-shadow: 0 0 15px rgba(0, 204, 255, 0.3);
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(90deg, #00ff88, #00ccff);
            color: #000;
            border: none;
            border-radius: 10px;
            font-size: 1.3rem;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 255, 136, 0.3);
        }

        .key-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 25px;
        }

        .key-option-btn {
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #444;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .key-option-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: #ff3366;
            transform: translateY(-2px);
        }

        .key-option-btn i {
            font-size: 1.3rem;
        }

        .buy-key {
            background: linear-gradient(90deg, #ff3366, #ff9966);
            border-color: #ff3366;
        }

        /* Time Remaining Display */
        .time-remaining {
            margin-top: 15px;
            padding: 10px;
            background: linear-gradient(90deg, #ffcc00, #ff9900);
            color: #000;
            border-radius: 10px;
            font-weight: bold;
            font-size: 1.1rem;
            display: none;
        }

        /* Expired Popup */
        .expired-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 9999;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .expired-popup-content {
            background: linear-gradient(135deg, #ff3366, #cc0000);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            border: 5px solid #fff;
            box-shadow: 0 0 50px rgba(255, 51, 102, 0.8);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .expired-popup h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: white;
        }

        .expired-popup p {
            font-size: 1.3rem;
            margin-bottom: 30px;
        }

        .expired-popup button {
            padding: 15px 30px;
            background: white;
            color: #ff3366;
            border: none;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .expired-popup button:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 20px rgba(255, 255, 255, 0.3);
        }

        /* Admin Panel Button */
        .admin-panel-btn {
            position: fixed;
            bottom: 10px;
            right: 10px;
            width: 5px;
            height: 5px;
            background: rgba(0, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            z-index: 9998;
            opacity: 0.01;
            transition: opacity 0.3s ease;
        }

        .admin-panel-btn:hover {
            opacity: 0.1;
        }

        /* Admin Panel */
        .admin-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(20, 20, 20, 0.98);
            border-radius: 20px;
            padding: 30px;
            border: 3px solid #00ccff;
            box-shadow: 0 0 50px rgba(0, 204, 255, 0.5);
            z-index: 9999;
            display: none;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            backdrop-filter: blur(10px);
        }

        .admin-panel h2 {
            color: #00ccff;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2rem;
            text-shadow: 0 0 10px rgba(0, 204, 255, 0.5);
        }

        /* Admin Tabs */
        .admin-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #444;
        }

        .admin-tab {
            padding: 10px 20px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
            transition: all 0.3s ease;
        }

        .admin-tab.active {
            background: linear-gradient(90deg, #00ccff, #0088ff);
            color: white;
            font-weight: bold;
        }

        .admin-tab:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Admin Tab Content */
        .admin-tab-content {
            display: none;
        }

        .admin-tab-content.active {
            display: block;
        }

        .admin-input-group {
            margin-bottom: 20px;
        }

        .admin-input-group label {
            display: block;
            margin-bottom: 8px;
            color: #aaa;
        }

        .admin-input-group input {
            width: 100%;
            padding: 12px 15px;
            border-radius: 10px;
            border: 2px solid #444;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 1rem;
        }

        .admin-input-group input:focus {
            outline: none;
            border-color: #00ccff;
        }

        .admin-btn {
            width: 100%;
            padding: 15px;
            margin-top: 10px;
            background: linear-gradient(90deg, #00ff88, #00ccff);
            color: #000;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 255, 136, 0.3);
        }

        .admin-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #ff3366;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
        }

        /* Generated Key Display */
        .generated-key-display {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            text-align: center;
            display: none;
        }

        .generated-key-display .key {
            font-size: 1.5rem;
            font-weight: bold;
            color: #00ff88;
            letter-spacing: 3px;
            margin: 10px 0;
        }

        .key-info {
            color: #aaa;
            font-size: 0.9rem;
        }

        /* Key History Table */
        .key-history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            overflow: hidden;
        }

        .key-history-table th {
            background: linear-gradient(90deg, #00ccff, #0088ff);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }

        .key-history-table td {
            padding: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: #ccc;
        }

        .key-history-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .key-status-active {
            color: #00ff88;
            font-weight: bold;
        }

        .key-status-expired {
            color: #ff3366;
            font-weight: bold;
        }

        .delete-key-btn {
            padding: 5px 10px;
            background: #ff3366;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .delete-key-btn:hover {
            background: #cc0000;
        }

        /* Prediction Page */
        .prediction-header {
            text-align: center;
            padding: 25px 20px;
            background: linear-gradient(180deg, rgba(10,10,10,0.95), rgba(20,20,20,0.9));
            border-bottom: 2px solid #333;
        }

        .prediction-header h1 {
            font-size: 2.8rem;
            background: linear-gradient(90deg, #fff, #aaa);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 15px;
            letter-spacing: 3px;
            font-weight: 800;
            text-transform: uppercase;
        }

        .server-status-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .server-item {
            text-align: center;
        }

        .server-label {
            font-size: 1rem;
            color: #aaa;
            margin-bottom: 5px;
            letter-spacing: 1px;
        }

        .server-value {
            padding: 8px 20px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 1.1rem;
            letter-spacing: 1px;
            min-width: 180px;
        }

        .server-connected {
            background: #00ff88;
            color: #000;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }

        .server-select {
            background: #ff3366;
            color: #fff;
            box-shadow: 0 0 10px rgba(255, 51, 102, 0.5);
        }

        /* Game Info */
        .game-info {
            text-align: center;
            padding: 25px;
            margin: 25px auto;
            background: rgba(30, 30, 30, 0.8);
            border-radius: 15px;
            border: 2px solid #333;
            max-width: 600px;
            backdrop-filter: blur(10px);
        }

        .period-display {
            font-size: 1.3rem;
            color: #00ccff;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }

        .period-number {
            font-size: 2.2rem;
            font-weight: bold;
            color: #fff;
            letter-spacing: 3px;
            text-shadow: 0 0 10px rgba(0, 204, 255, 0.5);
        }

        /* Winning Proofs */
        .winning-proofs {
            padding: 25px;
            margin: 25px;
            background: linear-gradient(135deg, rgba(255, 140, 0, 0.15), rgba(255, 69, 0, 0.1));
            border-radius: 20px;
            border: 2px solid #ff8c00;
            box-shadow: 0 10px 30px rgba(255, 140, 0, 0.2);
        }

        .proofs-header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 140, 0, 0.3);
        }

        .proofs-header h3 {
            color: #ff8c00;
            font-size: 1.8rem;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 140, 0, 0.5);
            letter-spacing: 2px;
        }

        .proofs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            max-height: 400px;
            overflow-y: auto;
            padding: 15px;
        }

        .proof-card {
            background: linear-gradient(145deg, rgba(255, 140, 0, 0.2), rgba(255, 69, 0, 0.15));
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #ff8c00;
            position: relative;
            overflow: hidden;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .proof-card::before {
            content: 'VERIFIED WIN';
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(90deg, #ff8c00, #ffa500);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .winner-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .winner-name {
            font-size: 1.3rem;
            color: #ffcc00;
            font-weight: bold;
        }

        .win-amount {
            font-size: 1.8rem;
            color: #00ff88;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }

        .winner-info {
            margin-top: 10px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            font-size: 0.9rem;
            color: #ccc;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .info-label {
            color: #aaa;
        }

        .info-value {
            color: #fff;
            font-weight: bold;
        }

        /* PREDICTION BOX */
        .prediction-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 300px;
            padding: 20px;
            margin: 20px auto;
            max-width: 800px;
        }

        .prediction-box-wrapper {
            width: 350px;
            background: rgba(40, 40, 40, 0.9);
            border-radius: 20px;
            border: 2px solid #444;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }

        .server-selection {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #444;
        }

        .server-type {
            font-size: 1.1rem;
            color: #aaa;
            letter-spacing: 1px;
        }

        .server-type-value {
            font-size: 1.2rem;
            color: #00ccff;
            font-weight: bold;
            text-transform: uppercase;
        }

        .prediction-content {
            text-align: center;
            padding: 20px 0;
        }

        .prediction-label {
            font-size: 1rem;
            color: #aaa;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }

        .prediction-value {
            font-size: 4.5rem;
            font-weight: 800;
            letter-spacing: 3px;
            text-transform: uppercase;
            margin: 15px 0;
            text-shadow: 0 0 20px currentColor;
        }

        .prediction-green {
            color: #00ff88;
        }

        .prediction-red {
            color: #ff3366;
        }

        .prediction-big {
            color: #ffcc00;
        }

        .prediction-small {
            color: #00ccff;
        }

        .server-select-section {
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid #444;
            text-align: center;
        }

        .server-select-label {
            font-size: 1rem;
            color: #aaa;
            margin-bottom: 10px;
        }

        .server-select-value {
            font-size: 1.3rem;
            color: #ff3366;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* Back Button */
        .back-btn {
            position: fixed;
            bottom: 25px;
            left: 25px;
            background: linear-gradient(90deg, #ff3366, #ff6699);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(255, 51, 102, 0.4);
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(255, 51, 102, 0.6);
        }

        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        .prediction-status {
            text-align: center;
            color: #aaa;
            font-size: 0.9rem;
            margin-top: 10px;
            min-height: 20px;
        }

        /* Smart Analysis Section */
        .smart-analysis {
            background: rgba(30, 30, 30, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin: 20px auto;
            max-width: 800px;
            border: 2px solid #444;
        }

        .smart-analysis-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #444;
        }

        .smart-analysis-header h3 {
            color: #00ccff;
            font-size: 1.5rem;
        }

        /* Analysis Stats */
        .analysis-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid #444;
            text-align: center;
        }

        .stat-card.active {
            border-color: #00ff88;
            background: rgba(0, 255, 136, 0.1);
        }

        .stat-card.loss {
            border-color: #ff3366;
            background: rgba(255, 51, 102, 0.1);
        }

        .stat-label {
            font-size: 0.9rem;
            color: #aaa;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #fff;
        }

        .stat-percentage {
            font-size: 0.8rem;
            color: #ffcc00;
            margin-top: 5px;
        }

        /* Next Prediction Info */
        .next-prediction-info {
            background: linear-gradient(135deg, rgba(0, 100, 255, 0.1), rgba(0, 50, 150, 0.1));
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #0088ff;
            text-align: center;
        }

        .next-prediction-header h4 {
            color: #0088ff;
            font-size: 1.3rem;
            margin-bottom: 10px;
        }

        .prediction-reason {
            color: #aaa;
            font-size: 0.9rem;
            margin: 10px 0;
            line-height: 1.4;
        }

        /* Pattern Display */
        .pattern-display {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 8px;
            margin: 15px 0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }

        .pattern-item {
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            font-size: 1rem;
            min-height: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .pattern-big {
            background: linear-gradient(135deg, #ff9966, #ff3366);
            color: white;
        }

        .pattern-small {
            background: linear-gradient(135deg, #00ccff, #0088ff);
            color: white;
        }

        .pattern-red {
            background: linear-gradient(135deg, #ff3366, #cc0000);
            color: white;
        }

        .pattern-green {
            background: linear-gradient(135deg, #00ff88, #00cc66);
            color: white;
        }

        .pattern-number {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-top: 2px;
        }

        .pattern-index {
            position: absolute;
            top: 2px;
            left: 2px;
            font-size: 0.6rem;
            opacity: 0.7;
        }

        /* Confidence Indicator */
        .confidence-indicator {
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin: 10px 0;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        .confidence-high {
            background: linear-gradient(90deg, #00ff88, #00cc66);
        }

        .confidence-medium {
            background: linear-gradient(90deg, #ffcc00, #ff9900);
        }

        .confidence-low {
            background: linear-gradient(90deg, #ff3366, #cc0000);
        }

        /* Loss Recovery Info */
        .loss-recovery {
            background: linear-gradient(135deg, rgba(255, 51, 102, 0.1), rgba(204, 0, 0, 0.05));
            border-radius: 15px;
            padding: 15px;
            margin: 15px 0;
            border: 2px solid #ff3366;
            display: none;
        }

        .loss-recovery.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .loss-recovery-header {
            text-align: center;
            margin-bottom: 10px;
        }

        .loss-recovery-header h4 {
            color: #ff3366;
            font-size: 1.2rem;
        }

        .recovery-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .recovery-stat {
            text-align: center;
            padding: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }

        .recovery-label {
            font-size: 0.8rem;
            color: #aaa;
        }

        .recovery-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: #fff;
        }

        /* System Intelligence Status */
        .system-intelligence {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #00ccff;
        }

        .system-intelligence h4 {
            color: #00ccff;
            margin-bottom: 10px;
        }

        .intelligence-status {
            color: #aaa;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* Dynamic Strategy Display */
        .strategy-display {
            background: linear-gradient(135deg, rgba(255, 204, 0, 0.1), rgba(255, 153, 0, 0.05));
            border-radius: 15px;
            padding: 15px;
            margin: 15px 0;
            border: 2px solid #ffcc00;
        }

        .strategy-header {
            text-align: center;
            margin-bottom: 10px;
        }

        .strategy-header h4 {
            color: #ffcc00;
            font-size: 1.2rem;
        }

        .strategy-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .strategy-item {
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }

        .strategy-label {
            font-size: 0.8rem;
            color: #aaa;
            margin-bottom: 5px;
        }

        .strategy-value {
            font-size: 1rem;
            font-weight: bold;
            color: #fff;
        }

        /* Server Switch Indicator */
        .server-switch {
            text-align: center;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin: 10px 0;
            animation: blink 2s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .server-switch i {
            color: #00ff88;
            margin-right: 10px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .platform-box {
                width: 280px;
                height: 500px;
            }
            
            .platform-image-container {
                height: 350px;
            }
            
            .prediction-value {
                font-size: 3.5rem;
            }
            
            .header h1 {
                font-size: 2.2rem;
            }
            
            .proofs-grid {
                grid-template-columns: 1fr;
            }
            
            .server-value {
                min-width: 150px;
                padding: 8px 15px;
                font-size: 1rem;
            }
            
            .online-users {
                position: relative;
                top: 0;
                right: 0;
                margin: 10px auto;
                width: fit-content;
            }
            
            .prediction-box-wrapper {
                width: 90%;
                padding: 20px;
            }
            
            .analysis-stats {
                grid-template-columns: 1fr;
            }
            
            .pattern-display {
                grid-template-columns: repeat(5, 1fr);
                grid-template-rows: repeat(2, 1fr);
            }
            
            .strategy-details {
                grid-template-columns: 1fr;
            }
            
            .recovery-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .smart-analysis {
                margin: 20px 10px;
                padding: 15px;
            }
            
            .access-key-container {
                padding: 20px;
            }
            
            .skip-btn {
                bottom: 20px;
                right: 20px;
                padding: 10px 20px;
                font-size: 1rem;
            }
            
            .admin-panel {
                width: 95%;
                padding: 20px;
            }
            
            .key-history-table {
                font-size: 0.8rem;
            }
            
            .key-history-table th,
            .key-history-table td {
                padding: 8px 5px;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Particles Background -->
    <div id="particles-js"></div>

    <!-- Landing Page -->
    <div id="landing-page">
        <div class="header">
            <h1>MICKEY X WEB</h1>
            <p>Dynamic Psychology Prediction System</p>
            <div class="online-users">
                <i class="fas fa-users"></i> ONLINE: 999+
            </div>
        </div>

        <div class="platform-section">
            <h2>SELECT PLATFORM</h2>
            <div class="platform-container">
                <!-- 91 Club Platform -->
                <div class="platform-box" onclick="selectPlatform('91 CLUB')">
                    <div class="platform-image-container">
                        <img src="91club.png" alt="91Club" onerror="this.onerror=null; this.src='https://via.placeholder.com/300x400/ff3366/000000?text=91CLUB'">
                    </div>
                    <div class="platform-name">91 Club</div>
                    <div class="select-btn">
                        <i class="fas fa-play"></i>
                    </div>
                </div>

                <!-- Tashan Platform -->
                <div class="platform-box" onclick="selectPlatform('TASHAN WIN')">
                    <div class="platform-image-container">
                        <img src="tashan.png" alt="Tashan" onerror="this.onerror=null; this.src='https://via.placeholder.com/300x400/00ccff/000000?text=TASHAN'">
                    </div>
                    <div class="platform-name">Tashan Win</div>
                    <div class="select-btn">
                        <i class="fas fa-play"></i>
                    </div>
                </div>

                <!-- 82 Lottery Platform -->
                <div class="platform-box" onclick="selectPlatform('82 LOTTERY')">
                    <div class="platform-image-container">
                        <img src="82lottery.png" alt="82Lottery" onerror="this.onerror=null; this.src='https://via.placeholder.com/300x400/ffcc00/000000?text=82LOTTO'">
                    </div>
                    <div class="platform-name">82 Lottery</div>
                    <div class="select-btn">
                        <i class="fas fa-play"></i>
                    </div>
                </div>

                <!-- Goa Game Platform -->
                <div class="platform-box" onclick="selectPlatform('GOA GAME')">
                    <div class="platform-image-container">
                        <img src="goagame.png" alt="GoaGame" onerror="this.onerror=null; this.src='https://via.placeholder.com/300x400/00ff88/000000?text=GOAGAME'">
                    </div>
                    <div class="platform-name">Goa Game</div>
                    <div class="select-btn">
                        <i class="fas fa-play"></i>
                    </div>
                </div>

                <!-- Daman Platform -->
                <div class="platform-box" onclick="selectPlatform('DAMAN GAME')">
                    <div class="platform-image-container">
                        <img src="daman.png" alt="Daman" onerror="this.onerror=null; this.src='https://via.placeholder.com/300x400/ff00ff/000000?text=DAMAN'">
                    </div>
                    <div class="platform-name">Daman Game</div>
                    <div class="select-btn">
                        <i class="fas fa-play"></i>
                    </div>
                </div>

                <!-- BDG Game Platform -->
                <div class="platform-box" onclick="selectPlatform('BDG GAME')">
                    <div class="platform-image-container">
                        <img src="bdggame.png" alt="BDGGame" onerror="this.onerror=null; this.src='https://via.placeholder.com/300x400/ff3366/000000?text=BDGGAME'">
                    </div>
                    <div class="platform-name">BDG Game</div>
                    <div class="select-btn">
                        <i class="fas fa-play"></i>
                    </div>
                </div>

                <!-- Jalwa Platform -->
                <div class="platform-box" onclick="selectPlatform('JALWA GAME')">
                    <div class="platform-image-container">
                        <img src="jalwa.png" alt="Jalwa" onerror="this.onerror=null; this.src='https://via.placeholder.com/300x400/00ccff/000000?text=JALWA'">
                    </div>
                    <div class="platform-name">Jalwa Game</div>
                    <div class="select-btn">
                        <i class="fas fa-play"></i>
                    </div>
                </div>

                <!-- DM Win Platform -->
                <div class="platform-box" onclick="selectPlatform('DM WIN')">
                    <div class="platform-image-container">
                        <img src="dmwin.png" alt="DMWin" onerror="this.onerror=null; this.src='https://via.placeholder.com/300x400/ffcc00/000000?text=DMWIN'">
                    </div>
                    <div class="platform-name">DM Win</div>
                    <div class="select-btn">
                        <i class="fas fa-play"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Video Page -->
    <div id="video-page">
        <div class="video-container">
            <video id="introVideo" autoplay>
                <source src="intro.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <button class="skip-btn" onclick="skipVideo()">
                <i class="fas fa-forward"></i> SKIP INTRO
            </button>
        </div>
    </div>

    <!-- Sorry Video Page -->
    <div id="sorry-video-page" style="display: none;">
        <div class="video-container">
            <video id="sorryVideo" autoplay>
                <source src="sorry.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <div class="video-message">
                <h2>⚠️ Wrong Access Key!</h2>
                <p>Brother galt key nhi dalna hai key leke aao pehele ok</p>
            </div>
        </div>
    </div>

    <!-- Access Key Page -->
    <div id="access-key-page">
        <div class="access-key-container">
            <h2><i class="fas fa-key"></i> ACCESS KEY REQUIRED</h2>
            <p>Enter your access key to unlock prediction features. If you don't have a key, you can purchase one.</p>
            
            <div class="key-input-group">
                <input type="password" id="accessKeyInput" placeholder="Enter Access Key" maxlength="10">
            </div>
            
            <button class="submit-btn" onclick="verifyAccessKey()">
                <i class="fas fa-unlock"></i> UNLOCK PREDICTIONS
            </button>
            
            <div class="time-remaining" id="timeRemaining">
                <i class="fas fa-clock"></i> Time Remaining: <span id="countdownTimer">00:00:00</span>
            </div>
            
            <div class="key-options">
                <button class="key-option-btn buy-key" onclick="buyKey()">
                    <i class="fas fa-shopping-cart"></i> Buy Key - Click Here
                </button>
            </div>
            
            <div class="back-to-platform" onclick="goBackToPlatform()">
                <i class="fas fa-arrow-left"></i> Back to Platform Selection
            </div>
        </div>
    </div>

    <!-- Prediction Page -->
    <div id="prediction-page">
        <div class="prediction-header">
            <h1>MICKEY X WEB</h1>
            <div class="online-users">
                <i class="fas fa-users"></i> ONLINE: 999+
            </div>
            
            <div class="server-status-container">
                <div class="server-item">
                    <div class="server-label">SERVER 1</div>
                    <div class="server-value server-connected" id="server1">CONNECTED</div>
                </div>
                <div class="server-item">
                    <div class="server-label">SERVER SELECT</div>
                    <div class="server-value server-select" id="server2">RED/GREEN</div>
                </div>
            </div>
        </div>

        <!-- Winning Proofs Section -->
        <div class="winning-proofs">
            <div class="proofs-header">
                <h3><i class="fas fa-trophy"></i> WINNING PROOFS - VERIFIED RESULTS ❤️ <i class="fas fa-trophy"></i></h3>
                <p style="color: #aaa; margin-top: 10px;">Live winning proofs from our users</p>
            </div>
            <div class="proofs-grid" id="proofsList">
                <!-- Proofs will be loaded from Firebase and auto-generated -->
            </div>
        </div>

        <!-- Server Switch Indicator -->
        <div class="server-switch" id="serverSwitchIndicator" style="display: none;">
            <i class="fas fa-sync-alt"></i> Switching to better server after loss analysis...
        </div>

        <!-- Loss Recovery Section -->
        <div class="loss-recovery" id="lossRecoverySection">
            <div class="loss-recovery-header">
                <h4><i class="fas fa-redo"></i> LOSS RECOVERY MODE ACTIVATED</h4>
            </div>
            <div class="recovery-stats">
                <div class="recovery-stat">
                    <div class="recovery-label">Consecutive Losses</div>
                    <div class="recovery-value" id="consecutiveLossesCount">0</div>
                </div>
                <div class="recovery-stat">
                    <div class="recovery-label">Recovery Strategy</div>
                    <div class="recovery-value" id="recoveryStrategy">Analyzing...</div>
                </div>
                <div class="recovery-stat">
                    <div class="recovery-label">Next Prediction Accuracy</div>
                    <div class="recovery-value" id="recoveryAccuracy">85%</div>
                </div>
            </div>
        </div>

        <!-- Smart Analysis Section -->
        <div class="smart-analysis">
            <div class="smart-analysis-header">
                <h3><i class="fas fa-brain"></i> DYNAMIC INTELLIGENCE ANALYSIS</h3>
                <p style="color: #aaa; font-size: 0.9rem;">Real-time pattern detection & strategy adjustment</p>
            </div>

            <!-- Analysis Stats -->
            <div class="analysis-stats">
                <div class="stat-card" id="winRateCard">
                    <div class="stat-label">WIN RATE</div>
                    <div class="stat-value" id="winRate">75%</div>
                    <div class="stat-percentage" id="winRateTrend">↑ 5% today</div>
                </div>
                <div class="stat-card" id="streakCard">
                    <div class="stat-label">CURRENT STREAK</div>
                    <div class="stat-value" id="currentStreak">3 Wins</div>
                    <div class="stat-percentage" id="streakType">Positive</div>
                </div>
                <div class="stat-card active" id="accuracyCard">
                    <div class="stat-label">PREDICTION ACCURACY</div>
                    <div class="stat-value" id="predictionAccuracy">82%</div>
                    <div class="stat-percentage">Last 10 predictions</div>
                </div>
                <div class="stat-card" id="serverCard">
                    <div class="stat-label">ACTIVE SERVER</div>
                    <div class="stat-value" id="activeServerValue">COLOR</div>
                    <div class="stat-percentage" id="serverAccuracy">78% accurate</div>
                </div>
            </div>

            <!-- Next Prediction Info -->
            <div class="next-prediction-info">
                <div class="next-prediction-header">
                    <h4><i class="fas fa-bullseye"></i> NEXT PREDICTION ANALYSIS</h4>
                </div>
                <div class="prediction-reason" id="predictionReason">
                    Analyzing last 10 results to determine optimal prediction...
                </div>
                <div class="confidence-indicator">
                    <div class="confidence-fill confidence-high" id="confidenceFill" style="width: 85%"></div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                    <span style="font-size: 0.8rem; color: #aaa;">Confidence:</span>
                    <span style="font-size: 0.8rem; font-weight: bold; color: #00ff88;" id="confidenceValue">85%</span>
                </div>
            </div>

            <!-- Strategy Display -->
            <div class="strategy-display" id="strategyDisplay">
                <div class="strategy-header">
                    <h4><i class="fas fa-chess-queen"></i> ACTIVE STRATEGY</h4>
                </div>
                <div class="strategy-details">
                    <div class="strategy-item">
                        <div class="strategy-label">Pattern Detected</div>
                        <div class="strategy-value" id="detectedPattern">Alternating</div>
                    </div>
                    <div class="strategy-item">
                        <div class="strategy-label">User Psychology</div>
                        <div class="strategy-value" id="userPsychology">Will choose BIG</div>
                    </div>
                    <div class="strategy-item">
                        <div class="strategy-label">Our Strategy</div>
                        <div class="strategy-value" id="ourStrategy">Counter Psychology</div>
                    </div>
                    <div class="strategy-item">
                        <div class="strategy-label">Risk Level</div>
                        <div class="strategy-value" id="riskLevel">Medium</div>
                    </div>
                </div>
            </div>

            <!-- Pattern Display -->
            <div class="pattern-display" id="patternDisplay">
                <!-- Last 10 results pattern will be displayed here -->
            </div>

            <!-- System Intelligence Status -->
            <div class="system-intelligence">
                <h4><i class="fas fa-cogs"></i> SYSTEM INTELLIGENCE STATUS</h4>
                <div class="intelligence-status" id="intelligenceStatus">
                    System analyzing real-time data for next prediction...
                </div>
            </div>
        </div>

        <div class="game-info">
            <div class="period-display">NEXT GAME PERIOD :</div>
            <div class="period-number" id="periodNumber">20250125100051349</div>
            <div class="prediction-status" id="predictionStatus">Dynamic analysis in progress...</div>
        </div>

        <!-- PREDICTION BOX -->
        <div class="prediction-container">
            <div class="prediction-box-wrapper">
                <div class="server-selection">
                    <div class="server-type">SERVER TYPE</div>
                    <div class="server-type-value" id="serverTypeLabel">COLOR SERVER</div>
                </div>
                
                <div class="prediction-content">
                    <div class="prediction-label">INTELLIGENT PREDICTION</div>
                    <div class="prediction-value" id="predictionText">GREEN</div>
                    <div class="prediction-label" style="font-size: 0.9rem; color: #ffcc00;">
                        <i class="fas fa-chart-line"></i> Dynamic Strategy Active
                    </div>
                </div>
                
                <div class="server-select-section">
                    <div class="server-select-label">SERVER SELECT</div>
                    <div class="server-select-value" id="serverSelectValue">RED/GREEN</div>
                </div>
            </div>
        </div>

        <button class="back-btn" onclick="goBack()">
            <i class="fas fa-arrow-left"></i> BACK TO PLATFORMS
        </button>
    </div>

    <!-- Expired Key Popup -->
    <div class="expired-popup" id="expiredPopup">
        <div class="expired-popup-content">
            <h2><i class="fas fa-exclamation-triangle"></i> KEY EXPIRED!</h2>
            <p>Your access key has expired. Please purchase a new key to continue using the prediction system.</p>
            <button onclick="redirectToKeyPage()">OK</button>
        </div>
    </div>

    <!-- Admin Panel Button -->
    <button class="admin-panel-btn" onclick="showAdminLogin()" title="Admin Panel"></button>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <button class="admin-close-btn" onclick="closeAdminPanel()">X</button>
        <h2><i class="fas fa-user-shield"></i> ADMIN PANEL</h2>
        
        <div class="admin-tabs">
            <div class="admin-tab active" id="generateKeyTabBtn" onclick="showAdminTab('generateKey')">
                Generate Key
            </div>
            <div class="admin-tab" id="keyHistoryTabBtn" onclick="showAdminTab('keyHistory')">
                Key History
            </div>
        </div>
        
        <div id="generateKeyTab" class="admin-tab-content active">
            <div class="admin-input-group">
                <label for="adminPassword">Admin Password</label>
                <input type="password" id="adminPassword" placeholder="Enter admin password">
            </div>
            
            <button class="admin-btn" onclick="loginAdmin()">
                <i class="fas fa-sign-in-alt"></i> LOGIN
            </button>
            
            <div id="generateKeyControls" style="display: none; margin-top: 30px;">
                <div class="admin-input-group">
                    <label for="keyDuration">Key Duration (Minutes)</label>
                    <input type="number" id="keyDuration" placeholder="30" min="1" max="1440">
                </div>
                
                <button class="admin-btn" onclick="generateTimeLimitedKey()">
                    <i class="fas fa-key"></i> GENERATE KEY
                </button>
                
                <div class="generated-key-display" id="generatedKeyDisplay">
                    <h3>Generated Key:</h3>
                    <div class="key" id="generatedKey">XXXX-XXXX-XXXX</div>
                    <div class="key-info">
                        Duration: <span id="keyDurationDisplay">0</span> minutes<br>
                        Expires: <span id="keyExpiresAt">Never</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="keyHistoryTab" class="admin-tab-content">
            <div class="admin-input-group">
                <label for="historyAdminPassword">Admin Password</label>
                <input type="password" id="historyAdminPassword" placeholder="Enter admin password">
            </div>
            
            <button class="admin-btn" onclick="loginHistoryAdmin()">
                <i class="fas fa-sign-in-alt"></i> LOGIN TO VIEW HISTORY
            </button>
            
            <div id="keyHistoryContent" style="display: none; margin-top: 20px;">
                <h3>Key History</h3>
                <div id="keyHistoryList">
                    <!-- Key history will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="winSound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3"></audio>
    <audio id="loseSound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>
    <audio id="keySound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
    <audio id="wrongKeySound" src="https://assets.mixkit.co/sfx/preview/mixkit-warning-alarm-buzzer-1559.mp3"></audio>
    <audio id="strategySound" src="https://assets.mixkit.co/sfx/preview/mixkit-game-ball-tap-2073.mp3"></audio>

    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script>
        // ============================================
        // DYNAMIC PREDICTION SYSTEM WITH LOSS RECOVERY
        // ============================================

        // Particles Background
        particlesJS('particles-js', {
            particles: {
                number: { value: 80, density: { enable: true, value_area: 800 } },
                color: { value: ["#ff3366", "#00ff88", "#00ccff", "#ffcc00"] },
                shape: { type: "circle" },
                opacity: { value: 0.6, random: true },
                size: { value: 3, random: true },
                line_linked: {
                    enable: true,
                    distance: 150,
                    color: "#444",
                    opacity: 0.4,
                    width: 1
                },
                move: {
                    enable: true,
                    speed: 2,
                    direction: "none",
                    random: true,
                    straight: false,
                    out_mode: "out",
                    bounce: false
                }
            },
            interactivity: {
                detect_on: "canvas",
                events: {
                    onhover: { enable: true, mode: "repulse" },
                    onclick: { enable: true, mode: "push" }
                }
            }
        });

        // Global Variables
        let currentServer = 'color';
        let lastPrediction = null;
        let currentPeriod = '';
        let nextPeriod = '';
        let lastResult = '';
        let apiUrl = "https://draw.ar-lottery01.com/WinGo/WinGo_1M/GetHistoryIssuePage.json";
        let proofInterval = null;
        let currentPlatform = '';
        let lastProcessedPeriod = '';
        let predictionMadeForPeriod = '';
        let isWaitingForResult = false;
        let fetchInterval = null;
        let last10Numbers = [];
        let last10Types = [];
        let last10Colors = [];
        let consecutiveWins = 0;
        let consecutiveLosses = 0;
        let activeKey = null;
        let keyExpiryTime = null;
        let countdownInterval = null;
        let isAdminLoggedIn = false;
        let isHistoryAdminLoggedIn = false;
        let currentPrediction = null;
        let predictionLocked = false;
        
        // Advanced Tracking Variables
        let predictionHistory = [];
        let lastLossPeriod = null;
        let recoveryMode = false;
        let strategyChangeCount = 0;
        let lastPredictionStrategy = '';
        let serverSwitchHistory = [];
        let patternAnalysisData = [];
        
        // Performance Tracking
        let performanceStats = {
            totalPredictions: 0,
            correctPredictions: 0,
            winRate: 75,
            sizeServerAccuracy: 75,
            colorServerAccuracy: 68,
            currentStreak: 0,
            streakType: 'win',
            last10Accuracy: 82
        };
        
        // Strategy Bank
        const strategies = [
            { name: 'Counter Psychology', weight: 0.3, description: 'Opposite of user choice' },
            { name: 'Pattern Break', weight: 0.25, description: 'Break current streak' },
            { name: 'Least Chosen', weight: 0.2, description: 'Least frequent option' },
            { name: 'Smart Alternate', weight: 0.15, description: 'Alternate after 2 same' },
            { name: 'Random Shift', weight: 0.1, description: 'Random change after loss' }
        ];

        // Firebase references
        const FIREBASE_KEYS_PATH = 'generatedKeys';

        // Indian Names List
        const indianNames = [
            "Rajesh Kumar", "Priya Sharma", "Amit Patel", "Sneha Singh", "Rohit Verma", 
            "Anjali Gupta", "Vikram Yadav", "Pooja Mishra", "Sanjay Tiwari", "Neha Joshi",
            "Arun Deshmukh", "Swati Reddy", "Manoj Choudhary", "Kavita Nair", "Deepak Iyer",
            "Sunita Menon", "Ramesh Pillai", "Lakshmi Rao", "Suresh Bansal", "Meena Chatterjee",
            "Kiran Mehta", "Divya Saxena", "Harshad Shah", "Ritu Agarwal", "Nitin Kapoor",
            "Shalini Malhotra", "Prakash Sinha", "Geeta Biswas", "Vivek Trivedi", "Anita Dutta"
        ];

        // Platform List
        const platforms = [
            "91 CLUB", "TASHAN WIN", "82 LOTTERY", "GOA GAME", 
            "DAMAN GAME", "BDG GAME", "JALWA GAME", "DM WIN"
        ];

        // Admin Password
        const ADMIN_PASSWORD = "456";

        // Generate random key
        function generateRandomKey() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let key = '';
            for (let i = 0; i < 8; i++) {
                key += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return key;
        }

        // Show admin login
        function showAdminLogin() {
            document.getElementById('adminPanel').style.display = 'block';
        }

        // Close admin panel
        function closeAdminPanel() {
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('adminPassword').value = '';
            document.getElementById('generateKeyControls').style.display = 'none';
            document.getElementById('historyAdminPassword').value = '';
            document.getElementById('keyHistoryContent').style.display = 'none';
            isAdminLoggedIn = false;
            isHistoryAdminLoggedIn = false;
        }

        // Show admin tab
        function showAdminTab(tabName) {
            document.querySelectorAll('.admin-tab-content').forEach(tab => {
                tab.style.display = 'none';
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName + 'Tab').style.display = 'block';
            document.getElementById(tabName + 'Tab').classList.add('active');
            document.getElementById(tabName + 'TabBtn').classList.add('active');
            
            if (tabName === 'generateKey') {
                document.getElementById('generateKeyControls').style.display = isAdminLoggedIn ? 'block' : 'none';
            } else if (tabName === 'keyHistory') {
                document.getElementById('keyHistoryContent').style.display = isHistoryAdminLoggedIn ? 'block' : 'none';
                if (isHistoryAdminLoggedIn) {
                    loadKeyHistory();
                }
            }
        }

        // Login admin for generate key
        function loginAdmin() {
            const password = document.getElementById('adminPassword').value;
            if (password === ADMIN_PASSWORD) {
                isAdminLoggedIn = true;
                document.getElementById('generateKeyControls').style.display = 'block';
                document.getElementById('adminPassword').value = '';
                alert('Admin login successful!');
            } else {
                alert('Wrong password!');
            }
        }

        // Login admin for history
        function loginHistoryAdmin() {
            const password = document.getElementById('historyAdminPassword').value;
            if (password === ADMIN_PASSWORD) {
                isHistoryAdminLoggedIn = true;
                document.getElementById('keyHistoryContent').style.display = 'block';
                document.getElementById('historyAdminPassword').value = '';
                loadKeyHistory();
                alert('Admin login successful!');
            } else {
                alert('Wrong password!');
            }
        }

        // Generate time-limited key
        async function generateTimeLimitedKey() {
            if (!isAdminLoggedIn) {
                alert('Please login as admin first!');
                return;
            }

            const durationInput = document.getElementById('keyDuration');
            const duration = parseInt(durationInput.value);
            
            if (!duration || duration < 1) {
                alert('Please enter a valid duration in minutes!');
                return;
            }

            const key = generateRandomKey();
            const createdAt = Date.now();
            const expiresAt = createdAt + (duration * 60000);
            
            try {
                if (window.firebaseDatabase) {
                    const keyRef = window.firebaseRef(window.firebaseDatabase, `${FIREBASE_KEYS_PATH}/${key}`);
                    await window.firebaseSet(keyRef, {
                        key: key,
                        duration: duration,
                        createdAt: createdAt,
                        expiresAt: expiresAt,
                        status: 'active',
                        createdBy: 'admin',
                        usageCount: 0,
                        lastUsed: null,
                        lastUsedBy: null
                    });
                    
                    document.getElementById('generatedKey').textContent = key;
                    document.getElementById('keyDurationDisplay').textContent = duration;
                    
                    const expiryDate = new Date(expiresAt);
                    document.getElementById('keyExpiresAt').textContent = expiryDate.toLocaleString();
                    
                    document.getElementById('generatedKeyDisplay').style.display = 'block';
                    
                    alert(`Key generated successfully!\nKey: ${key}\nDuration: ${duration} minutes`);
                    
                    durationInput.value = '';
                    
                    if (isHistoryAdminLoggedIn) {
                        loadKeyHistory();
                    }
                } else {
                    alert('Firebase not initialized!');
                }
            } catch (error) {
                console.error('Error saving key to Firebase:', error);
                alert('Error generating key!');
            }
        }

        // Load key history
        async function loadKeyHistory() {
            try {
                const keyHistoryList = document.getElementById('keyHistoryList');
                keyHistoryList.innerHTML = '<p>Loading key history...</p>';
                
                if (!window.firebaseDatabase) {
                    keyHistoryList.innerHTML = '<p>Firebase not initialized!</p>';
                    return;
                }
                
                const keysRef = window.firebaseRef(window.firebaseDatabase, FIREBASE_KEYS_PATH);
                const queryRef = window.firebaseQuery(keysRef, window.firebaseOrderByChild('createdAt'));
                
                window.firebaseOnValue(queryRef, (snapshot) => {
                    const data = snapshot.val();
                    
                    if (!data) {
                        keyHistoryList.innerHTML = '<p>No keys generated yet.</p>';
                        return;
                    }
                    
                    let html = `
                        <div class="key-history-table-container" style="overflow-x: auto;">
                            <table class="key-history-table">
                                <thead>
                                    <tr>
                                        <th>Key</th>
                                        <th>Duration</th>
                                        <th>Created</th>
                                        <th>Expires</th>
                                        <th>Status</th>
                                        <th>Usage Count</th>
                                        <th>Last Used</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>`;
                    
                    const currentTime = Date.now();
                    const keys = Object.values(data);
                    
                    keys.sort((a, b) => b.createdAt - a.createdAt);
                    
                    keys.forEach(keyData => {
                        const createdDate = new Date(keyData.createdAt);
                        const expiryDate = new Date(keyData.expiresAt);
                        const lastUsedDate = keyData.lastUsed ? new Date(keyData.lastUsed) : null;
                        
                        let status = 'active';
                        let statusClass = 'key-status-active';
                        
                        if (currentTime > keyData.expiresAt) {
                            status = 'expired';
                            statusClass = 'key-status-expired';
                        }
                        
                        html += `
                            <tr>
                                <td><strong>${keyData.key}</strong></td>
                                <td>${keyData.duration} min</td>
                                <td>${createdDate.toLocaleString()}</td>
                                <td>${expiryDate.toLocaleString()}</td>
                                <td class="${statusClass}">${status.toUpperCase()}</td>
                                <td>${keyData.usageCount || 0}</td>
                                <td>${lastUsedDate ? lastUsedDate.toLocaleString() : 'Never'}</td>
                                <td>
                                    <button class="delete-key-btn" onclick="deleteKey('${keyData.key}')">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </td>
                            </tr>`;
                    });
                    
                    html += `</tbody></table></div>`;
                    keyHistoryList.innerHTML = html;
                });
            } catch (error) {
                console.error('Error loading key history:', error);
                document.getElementById('keyHistoryList').innerHTML = '<p>Error loading key history.</p>';
            }
        }

        // Delete key
        async function deleteKey(key) {
            if (!confirm(`Are you sure you want to delete key: ${key}?`)) {
                return;
            }
            
            try {
                if (window.firebaseDatabase) {
                    const keyRef = window.firebaseRef(window.firebaseDatabase, `${FIREBASE_KEYS_PATH}/${key}`);
                    await window.firebaseRemove(keyRef);
                    alert('Key deleted successfully!');
                    loadKeyHistory();
                }
            } catch (error) {
                console.error('Error deleting key:', error);
                alert('Error deleting key!');
            }
        }

        // Check if key is valid
        async function checkKeyValidity(key) {
            try {
                if (!window.firebaseDatabase) return { valid: false, reason: 'Firebase not initialized' };
                
                const keyRef = window.firebaseRef(window.firebaseDatabase, `${FIREBASE_KEYS_PATH}/${key}`);
                const snapshot = await window.firebaseGet(keyRef);
                
                if (snapshot.exists()) {
                    const keyData = snapshot.val();
                    const currentTime = Date.now();
                    
                    if (currentTime > keyData.expiresAt) {
                        await window.firebaseSet(keyRef, {
                            ...keyData,
                            status: 'expired'
                        });
                        return { valid: false, reason: 'expired' };
                    }
                    
                    const usageCount = (keyData.usageCount || 0) + 1;
                    
                    let userIp = 'Unknown';
                    try {
                        const ipResponse = await fetch('https://api.ipify.org?format=json');
                        const ipData = await ipResponse.json();
                        userIp = ipData.ip;
                    } catch (e) {
                        console.error('Error getting IP:', e);
                    }
                    
                    await window.firebaseSet(keyRef, {
                        ...keyData,
                        usageCount: usageCount,
                        lastUsed: currentTime,
                        lastUsedBy: userIp,
                        status: 'active'
                    });
                    
                    return { 
                        valid: true, 
                        expiresAt: keyData.expiresAt,
                        duration: keyData.duration,
                        keyData: keyData
                    };
                } else {
                    return { valid: false, reason: 'not found' };
                }
            } catch (error) {
                console.error('Error checking key:', error);
                return { valid: false, reason: 'error' };
            }
        }

        // Start countdown timer
        function startCountdownTimer(expiresAt) {
            if (countdownInterval) {
                clearInterval(countdownInterval);
            }
            
            function updateTimer() {
                const now = Date.now();
                const timeLeft = expiresAt - now;
                
                if (timeLeft <= 0) {
                    clearInterval(countdownInterval);
                    showKeyExpiredPopup();
                    return;
                }
                
                const hours = Math.floor(timeLeft / (1000 * 60 * 60));
                const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                
                document.getElementById('countdownTimer').textContent = 
                    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            updateTimer();
            countdownInterval = setInterval(updateTimer, 1000);
        }

        // Show key expired popup
        function showKeyExpiredPopup() {
            document.getElementById('expiredPopup').style.display = 'flex';
            
            if (proofInterval) clearInterval(proofInterval);
            if (fetchInterval) clearInterval(fetchInterval);
            if (countdownInterval) clearInterval(countdownInterval);
            
            document.getElementById('introVideo')?.pause();
            document.getElementById('sorryVideo')?.pause();
            
            document.getElementById('prediction-page').style.display = 'none';
        }

        // Redirect to key page
        function redirectToKeyPage() {
            document.getElementById('expiredPopup').style.display = 'none';
            document.getElementById('access-key-page').style.display = 'flex';
            document.getElementById('accessKeyInput').value = '';
            document.getElementById('accessKeyInput').placeholder = "Key expired! Enter new key";
        }

        // Platform Selection
        function selectPlatform(platform) {
            document.getElementById('landing-page').style.display = 'none';
            document.getElementById('video-page').style.display = 'block';
            currentPlatform = platform;
            
            const video = document.getElementById('introVideo');
            video.play();
            
            video.onended = function() {
                document.getElementById('video-page').style.display = 'none';
                document.getElementById('access-key-page').style.display = 'flex';
            };
        }

        // Skip video
        function skipVideo() {
            document.getElementById('video-page').style.display = 'none';
            document.getElementById('access-key-page').style.display = 'flex';
            document.getElementById('introVideo').pause();
        }

        // Verify access key
        async function verifyAccessKey() {
            const inputKey = document.getElementById('accessKeyInput').value.trim().toUpperCase();
            const keySound = document.getElementById('keySound');
            const wrongKeySound = document.getElementById('wrongKeySound');
            
            if (!inputKey) {
                alert('Please enter an access key!');
                return;
            }
            
            const keyCheck = await checkKeyValidity(inputKey);
            
            if (keyCheck.valid) {
                keySound.play();
                activeKey = inputKey;
                keyExpiryTime = keyCheck.expiresAt;
                
                document.getElementById('timeRemaining').style.display = 'block';
                startCountdownTimer(keyExpiryTime);
                
                goToPredictionPage(currentPlatform);
            } else {
                wrongKeySound.play();
                
                document.getElementById('access-key-page').style.display = 'none';
                document.getElementById('sorry-video-page').style.display = 'block';
                const sorryVideo = document.getElementById('sorryVideo');
                sorryVideo.play();
                
                sorryVideo.onended = function() {
                    document.getElementById('sorry-video-page').style.display = 'none';
                    document.getElementById('access-key-page').style.display = 'flex';
                    document.getElementById('accessKeyInput').value = '';
                    document.getElementById('accessKeyInput').placeholder = "Wrong key! Try again...";
                };
            }
        }

        // Buy key function
        function buyKey() {
            window.open('https://t.me/Predict456', '_blank');
        }

        // Go back to platform selection
        function goBackToPlatform() {
            document.getElementById('access-key-page').style.display = 'none';
            document.getElementById('landing-page').style.display = 'block';
            
            if (countdownInterval) {
                clearInterval(countdownInterval);
                countdownInterval = null;
            }
        }

        // Go to prediction page
        function goToPredictionPage(platform) {
            document.getElementById('access-key-page').style.display = 'none';
            document.getElementById('prediction-page').style.display = 'block';
            
            currentPlatform = platform;
            document.getElementById('server2').textContent = platform;
            
            // Reset all tracking variables
            resetPredictionSystem();
            
            startPredictionSystem();
        }

        // Reset prediction system
        function resetPredictionSystem() {
            lastProcessedPeriod = '';
            predictionMadeForPeriod = '';
            isWaitingForResult = false;
            last10Numbers = [];
            last10Types = [];
            last10Colors = [];
            consecutiveWins = 0;
            consecutiveLosses = 0;
            currentPrediction = null;
            predictionLocked = false;
            
            predictionHistory = [];
            lastLossPeriod = null;
            recoveryMode = false;
            strategyChangeCount = 0;
            lastPredictionStrategy = '';
            serverSwitchHistory = [];
            patternAnalysisData = [];
            
            // Reset performance stats
            performanceStats = {
                totalPredictions: 0,
                correctPredictions: 0,
                winRate: 75,
                sizeServerAccuracy: 75,
                colorServerAccuracy: 68,
                currentStreak: 0,
                streakType: 'win',
                last10Accuracy: 82
            };
            
            // Hide recovery section
            document.getElementById('lossRecoverySection').classList.remove('active');
            document.getElementById('serverSwitchIndicator').style.display = 'none';
        }

        // Back to platforms
        function goBack() {
            document.getElementById('prediction-page').style.display = 'none';
            document.getElementById('landing-page').style.display = 'block';
            
            if (proofInterval) {
                clearInterval(proofInterval);
                proofInterval = null;
            }
            if (fetchInterval) {
                clearInterval(fetchInterval);
                fetchInterval = null;
            }
            if (countdownInterval) {
                clearInterval(countdownInterval);
                countdownInterval = null;
            }
            
            resetPredictionSystem();
        }

        // Get type (Big/Small)
        function getType(num) {
            return num >= 5 ? "B" : "S";
        }

        // Get color (Red/Green)
        function getColor(num) {
            return num % 2 === 0 ? "R" : "G";
        }

        // Get size from type
        function getSizeFromType(type) {
            return type === 'B' ? 'BIG' : 'SMALL';
        }

        // Get color from code
        function getColorFromCode(color) {
            return color === 'R' ? 'RED' : 'GREEN';
        }

        // Calculate next period number
        function calculateNextPeriod(currentPeriod) {
            if (!currentPeriod) return '';
            
            const periodStr = currentPeriod.toString();
            const lastPart = periodStr.slice(-5);
            const prefix = periodStr.slice(0, -5);
            
            const nextNum = (parseInt(lastPart) + 1).toString().padStart(5, '0');
            return prefix + nextNum;
        }

        // DYNAMIC PREDICTION ALGORITHM WITH LOSS RECOVERY
        function dynamicPredictionAlgorithm(numbers, types, colors, isRecoveryMode = false) {
            const analysis = {
                sizePrediction: '',
                colorPrediction: '',
                confidence: 70,
                strategy: '',
                reason: '',
                shouldSwitchServer: false,
                recoveryMode: isRecoveryMode
            };
            
            if (numbers.length < 5) {
                analysis.reason = 'Insufficient data for analysis';
                return analysis;
            }
            
            // Analyze last 10 results
            const last5Numbers = numbers.slice(-5);
            const last5Types = types.slice(-5);
            const last5Colors = colors.slice(-5);
            
            // Calculate frequencies
            const bigCount = last5Types.filter(t => t === 'B').length;
            const smallCount = last5Types.filter(t => t === 'S').length;
            const redCount = last5Colors.filter(c => c === 'R').length;
            const greenCount = last5Colors.filter(c => c === 'G').length;
            
            // Detect patterns
            const patterns = detectPatterns(last5Types, last5Colors);
            
            // If in recovery mode (after loss), use aggressive strategy
            if (isRecoveryMode) {
                analysis.strategy = 'Aggressive Recovery';
                analysis.confidence = 85;
                
                // After loss, switch strategy completely
                if (lastPredictionStrategy === 'Counter Psychology') {
                    analysis.strategy = 'Pattern Break';
                    // Choose opposite of what would normally be chosen
                    if (currentServer === 'color') {
                        analysis.colorPrediction = redCount >= greenCount ? 'G' : 'R';
                        analysis.sizePrediction = getTypeFromColor(analysis.colorPrediction);
                    } else {
                        analysis.sizePrediction = bigCount >= smallCount ? 'S' : 'B';
                        analysis.colorPrediction = getColorFromType(analysis.sizePrediction);
                    }
                } else if (lastPredictionStrategy === 'Pattern Break') {
                    analysis.strategy = 'Least Chosen';
                    // Find least frequent in last 10
                    const leastFrequentType = findLeastFrequent(last5Types);
                    const leastFrequentColor = findLeastFrequent(last5Colors);
                    
                    if (currentServer === 'color') {
                        analysis.colorPrediction = leastFrequentColor;
                        analysis.sizePrediction = getTypeFromColor(analysis.colorPrediction);
                    } else {
                        analysis.sizePrediction = leastFrequentType;
                        analysis.colorPrediction = getColorFromType(analysis.sizePrediction);
                    }
                } else {
                    // Default to Counter Psychology
                    analysis.strategy = 'Counter Psychology';
                    if (currentServer === 'color') {
                        analysis.colorPrediction = redCount >= greenCount ? 'G' : 'R';
                        analysis.sizePrediction = getTypeFromColor(analysis.colorPrediction);
                    } else {
                        analysis.sizePrediction = bigCount >= smallCount ? 'S' : 'B';
                        analysis.colorPrediction = getColorFromType(analysis.sizePrediction);
                    }
                }
                
                analysis.reason = `Recovery mode: ${analysis.strategy} after loss`;
                analysis.shouldSwitchServer = Math.random() > 0.7; // 30% chance to switch server
            } 
            // Normal prediction mode
            else {
                // Choose strategy based on recent performance
                const strategyWeights = calculateStrategyWeights();
                const selectedStrategy = selectStrategy(strategyWeights);
                
                analysis.strategy = selectedStrategy.name;
                
                // Apply selected strategy
                switch(selectedStrategy.name) {
                    case 'Counter Psychology':
                        if (currentServer === 'color') {
                            analysis.colorPrediction = redCount >= greenCount ? 'G' : 'R';
                            analysis.sizePrediction = getTypeFromColor(analysis.colorPrediction);
                        } else {
                            analysis.sizePrediction = bigCount >= smallCount ? 'S' : 'B';
                            analysis.colorPrediction = getColorFromType(analysis.sizePrediction);
                        }
                        analysis.confidence = 75;
                        break;
                        
                    case 'Pattern Break':
                        // Break the current pattern
                        if (patterns.currentStreak >= 2) {
                            if (currentServer === 'color') {
                                analysis.colorPrediction = patterns.lastColor === 'R' ? 'G' : 'R';
                                analysis.sizePrediction = getTypeFromColor(analysis.colorPrediction);
                            } else {
                                analysis.sizePrediction = patterns.lastType === 'B' ? 'S' : 'B';
                                analysis.colorPrediction = getColorFromType(analysis.sizePrediction);
                            }
                        } else {
                            // If no streak, use counter psychology
                            if (currentServer === 'color') {
                                analysis.colorPrediction = redCount >= greenCount ? 'G' : 'R';
                                analysis.sizePrediction = getTypeFromColor(analysis.colorPrediction);
                            } else {
                                analysis.sizePrediction = bigCount >= smallCount ? 'S' : 'B';
                                analysis.colorPrediction = getColorFromType(analysis.sizePrediction);
                            }
                        }
                        analysis.confidence = 80;
                        break;
                        
                    case 'Least Chosen':
                        const leastFrequentType = findLeastFrequent(last5Types);
                        const leastFrequentColor = findLeastFrequent(last5Colors);
                        
                        if (currentServer === 'color') {
                            analysis.colorPrediction = leastFrequentColor;
                            analysis.sizePrediction = getTypeFromColor(analysis.colorPrediction);
                        } else {
                            analysis.sizePrediction = leastFrequentType;
                            analysis.colorPrediction = getColorFromType(analysis.sizePrediction);
                        }
                        analysis.confidence = 70;
                        break;
                        
                    case 'Smart Alternate':
                        // Alternate if last 2 were same
                        if (last5Types.length >= 2 && last5Types[0] === last5Types[1]) {
                            if (currentServer === 'color') {
                                analysis.colorPrediction = last5Colors[0] === 'R' ? 'G' : 'R';
                                analysis.sizePrediction = getTypeFromColor(analysis.colorPrediction);
                            } else {
                                analysis.sizePrediction = last5Types[0] === 'B' ? 'S' : 'B';
                                analysis.colorPrediction = getColorFromType(analysis.sizePrediction);
                            }
                        } else {
                            // Use counter psychology
                            if (currentServer === 'color') {
                                analysis.colorPrediction = redCount >= greenCount ? 'G' : 'R';
                                analysis.sizePrediction = getTypeFromColor(analysis.colorPrediction);
                            } else {
                                analysis.sizePrediction = bigCount >= smallCount ? 'S' : 'B';
                                analysis.colorPrediction = getColorFromType(analysis.sizePrediction);
                            }
                        }
                        analysis.confidence = 78;
                        break;
                        
                    default: // Random Shift
                        // Small random adjustment
                        if (Math.random() > 0.5) {
                            if (currentServer === 'color') {
                                analysis.colorPrediction = redCount >= greenCount ? 'G' : 'R';
                                analysis.sizePrediction = getTypeFromColor(analysis.colorPrediction);
                            } else {
                                analysis.sizePrediction = bigCount >= smallCount ? 'S' : 'B';
                                analysis.colorPrediction = getColorFromType(analysis.sizePrediction);
                            }
                        } else {
                            // Random flip
                            if (currentServer === 'color') {
                                analysis.colorPrediction = Math.random() > 0.5 ? 'R' : 'G';
                                analysis.sizePrediction = getTypeFromColor(analysis.colorPrediction);
                            } else {
                                analysis.sizePrediction = Math.random() > 0.5 ? 'B' : 'S';
                                analysis.colorPrediction = getColorFromType(analysis.sizePrediction);
                            }
                        }
                        analysis.confidence = 65;
                }
                
                analysis.reason = `${analysis.strategy}: ${selectedStrategy.description}`;
                analysis.shouldSwitchServer = Math.random() > 0.8; // 20% chance to switch server normally
            }
            
            // Adjust confidence based on pattern strength
            const patternStrength = Math.max(
                Math.abs(bigCount - smallCount),
                Math.abs(redCount - greenCount)
            );
            
            analysis.confidence = Math.min(90, analysis.confidence + (patternStrength * 3));
            
            // Store for next prediction
            lastPredictionStrategy = analysis.strategy;
            
            return analysis;
        }

        // Get type from color
        function getTypeFromColor(color) {
            // For simplicity, assume red is even (small/big doesn't matter for color)
            return Math.random() > 0.5 ? 'B' : 'S';
        }

        // Get color from type
        function getColorFromType(type) {
            // For simplicity, assume big is even (red/green doesn't matter for size)
            return Math.random() > 0.5 ? 'R' : 'G';
        }

        // Detect patterns in data
        function detectPatterns(types, colors) {
            const patterns = {
                currentStreak: 1,
                lastType: types[types.length - 1] || 'B',
                lastColor: colors[colors.length - 1] || 'R',
                isAlternating: true
            };
            
            // Check for streaks
            for (let i = types.length - 1; i > 0; i--) {
                if (types[i] === types[i-1]) {
                    patterns.currentStreak++;
                } else {
                    break;
                }
            }
            
            // Check for alternating pattern
            if (types.length >= 3) {
                for (let i = 2; i < types.length; i++) {
                    if (types[i] === types[i-2]) {
                        patterns.isAlternating = false;
                        break;
                    }
                }
            }
            
            return patterns;
        }

        // Find least frequent item in array
        function findLeastFrequent(arr) {
            if (arr.length === 0) return 'B';
            
            const counts = {};
            arr.forEach(item => {
                counts[item] = (counts[item] || 0) + 1;
            });
            
            let minCount = Infinity;
            let leastFrequent = arr[0];
            
            for (const item in counts) {
                if (counts[item] < minCount) {
                    minCount = counts[item];
                    leastFrequent = item;
                }
            }
            
            return leastFrequent;
        }

        // Calculate strategy weights based on recent performance
        function calculateStrategyWeights() {
            const weightedStrategies = [...strategies];
            
            // Adjust weights based on recent losses
            if (consecutiveLosses > 0) {
                weightedStrategies.forEach(strategy => {
                    if (strategy.name === 'Random Shift' || strategy.name === 'Pattern Break') {
                        strategy.weight *= 1.5; // Increase weight for change strategies
                    } else if (strategy.name === lastPredictionStrategy) {
                        strategy.weight *= 0.5; // Decrease weight for failed strategy
                    }
                });
            }
            
            // Normalize weights
            const totalWeight = weightedStrategies.reduce((sum, s) => sum + s.weight, 0);
            weightedStrategies.forEach(s => s.weight = s.weight / totalWeight);
            
            return weightedStrategies;
        }

        // Select strategy based on weights
        function selectStrategy(strategyWeights) {
            const rand = Math.random();
            let cumulativeWeight = 0;
            
            for (const strategy of strategyWeights) {
                cumulativeWeight += strategy.weight;
                if (rand <= cumulativeWeight) {
                    return strategy;
                }
            }
            
            return strategyWeights[0];
        }

        // Update display with analysis
        function updateDisplayWithAnalysis(numbers, types, colors, analysis) {
            // Update pattern display
            const patternDisplay = document.getElementById('patternDisplay');
            patternDisplay.innerHTML = '';
            
            const displayCount = Math.min(numbers.length, 10);
            
            for (let i = 0; i < displayCount; i++) {
                const item = document.createElement('div');
                item.className = 'pattern-item';
                
                // Show both size and color in pattern
                if (types[i] === 'B') {
                    item.classList.add('pattern-big');
                    item.textContent = 'B';
                } else {
                    item.classList.add('pattern-small');
                    item.textContent = 'S';
                }
                
                const numberSpan = document.createElement('div');
                numberSpan.className = 'pattern-number';
                numberSpan.textContent = numbers[i];
                item.appendChild(numberSpan);
                
                const indexSpan = document.createElement('div');
                indexSpan.className = 'pattern-index';
                indexSpan.textContent = i + 1;
                item.appendChild(indexSpan);
                
                item.title = `#${i+1}: ${numbers[i]} (${colors[i] === 'R' ? 'Red' : 'Green'}/${types[i] === 'B' ? 'Big' : 'Small'})`;
                patternDisplay.appendChild(item);
            }
            
            // Update stats
            document.getElementById('winRate').textContent = `${performanceStats.winRate}%`;
            document.getElementById('predictionAccuracy').textContent = `${performanceStats.last10Accuracy}%`;
            
            // Update streak display
            const streakCard = document.getElementById('streakCard');
            if (consecutiveWins > 0) {
                document.getElementById('currentStreak').textContent = `${consecutiveWins} Wins`;
                document.getElementById('streakType').textContent = 'Positive';
                streakCard.classList.remove('loss');
                streakCard.classList.add('active');
            } else if (consecutiveLosses > 0) {
                document.getElementById('currentStreak').textContent = `${consecutiveLosses} Losses`;
                document.getElementById('streakType').textContent = 'Recovering';
                streakCard.classList.remove('active');
                streakCard.classList.add('loss');
            } else {
                document.getElementById('currentStreak').textContent = 'Neutral';
                document.getElementById('streakType').textContent = 'Starting';
                streakCard.classList.remove('active', 'loss');
            }
            
            // Update server info
            document.getElementById('activeServerValue').textContent = currentServer === 'color' ? 'COLOR' : 'SIZE';
            document.getElementById('serverAccuracy').textContent = currentServer === 'color' ? 
                `${performanceStats.colorServerAccuracy}% accurate` : 
                `${performanceStats.sizeServerAccuracy}% accurate`;
            
            // Update strategy display
            document.getElementById('detectedPattern').textContent = getPatternDescription(types, colors);
            document.getElementById('userPsychology').textContent = getUserPsychologyPrediction(types, colors);
            document.getElementById('ourStrategy').textContent = analysis.strategy;
            document.getElementById('riskLevel').textContent = analysis.confidence > 80 ? 'Low' : analysis.confidence > 60 ? 'Medium' : 'High';
            
            // Update confidence display
            const confidenceFill = document.getElementById('confidenceFill');
            confidenceFill.style.width = `${analysis.confidence}%`;
            document.getElementById('confidenceValue').textContent = `${analysis.confidence}%`;
            
            // Update confidence color
            confidenceFill.className = 'confidence-fill ';
            if (analysis.confidence >= 80) {
                confidenceFill.classList.add('confidence-high');
            } else if (analysis.confidence >= 65) {
                confidenceFill.classList.add('confidence-medium');
            } else {
                confidenceFill.classList.add('confidence-low');
            }
            
            // Update prediction reason
            document.getElementById('predictionReason').textContent = analysis.reason;
            
            // Update intelligence status
            let statusText = `Using ${analysis.strategy} strategy`;
            if (analysis.recoveryMode) {
                statusText = `⚠️ Recovery Mode: ${analysis.strategy} (${analysis.confidence}% confidence)`;
            }
            document.getElementById('intelligenceStatus').textContent = statusText;
            
            // Update server card
            const serverCard = document.getElementById('serverCard');
            if (analysis.shouldSwitchServer) {
                serverCard.classList.add('active');
            } else {
                serverCard.classList.remove('active');
            }
            
            return analysis;
        }

        // Get pattern description
        function getPatternDescription(types, colors) {
            if (types.length < 3) return 'Insufficient data';
            
            // Check for streaks
            let typeStreak = 1;
            for (let i = types.length - 1; i > 0; i--) {
                if (types[i] === types[i-1]) typeStreak++;
                else break;
            }
            
            let colorStreak = 1;
            for (let i = colors.length - 1; i > 0; i--) {
                if (colors[i] === colors[i-1]) colorStreak++;
                else break;
            }
            
            if (typeStreak >= 3 || colorStreak >= 3) {
                return `${Math.max(typeStreak, colorStreak)} in row`;
            }
            
            // Check for alternating
            let isAlternating = true;
            for (let i = 2; i < Math.min(types.length, 5); i++) {
                if (types[i] !== types[i-2]) {
                    isAlternating = false;
                    break;
                }
            }
            
            if (isAlternating) return 'Alternating';
            
            return 'Mixed pattern';
        }

        // Get user psychology prediction
        function getUserPsychologyPrediction(types, colors) {
            if (types.length < 3) return 'Analyzing...';
            
            const last3Types = types.slice(-3);
            const last3Colors = colors.slice(-3);
            
            const bigCount = last3Types.filter(t => t === 'B').length;
            const redCount = last3Colors.filter(c => c === 'R').length;
            
            let prediction = '';
            
            if (currentServer === 'color') {
                prediction = redCount >= 2 ? 'Will choose RED' : 'Will choose GREEN';
            } else {
                prediction = bigCount >= 2 ? 'Will choose BIG' : 'Will choose SMALL';
            }
            
            return prediction;
        }

        // Switch server if needed
        function switchServerIfNeeded(shouldSwitch) {
            if (shouldSwitch && serverSwitchHistory.length < 3) {
                const strategySound = document.getElementById('strategySound');
                if (strategySound) {
                    strategySound.currentTime = 0;
                    strategySound.play();
                }
                
                // Show server switch indicator
                const switchIndicator = document.getElementById('serverSwitchIndicator');
                switchIndicator.style.display = 'block';
                setTimeout(() => {
                    switchIndicator.style.display = 'none';
                }, 3000);
                
                // Switch server
                currentServer = currentServer === 'color' ? 'size' : 'color';
                serverSwitchHistory.push({
                    from: currentServer === 'color' ? 'size' : 'color',
                    to: currentServer,
                    timestamp: Date.now(),
                    reason: 'Strategy adjustment'
                });
                
                // Update display
                if (currentServer === 'color') {
                    document.getElementById('serverTypeLabel').textContent = 'COLOR SERVER';
                    document.getElementById('serverSelectValue').textContent = 'RED/GREEN';
                } else {
                    document.getElementById('serverTypeLabel').textContent = 'SIZE SERVER';
                    document.getElementById('serverSelectValue').textContent = 'BIG/SMALL';
                }
                
                return true;
            }
            return false;
        }

        // Generate random winning proof
        function generateRandomWinningProof() {
            const randomName = indianNames[Math.floor(Math.random() * indianNames.length)];
            const randomPlatform = platforms[Math.floor(Math.random() * platforms.length)];
            const randomAmount = Math.floor(Math.random() * (100000 - 200 + 1)) + 200;
            const randomAccount = "****" + Math.floor(Math.random() * 10000).toString().padStart(4, '0');
            
            let randomPeriod;
            if (currentPeriod) {
                const periodNum = parseInt(currentPeriod.slice(-5));
                const randomOffset = Math.floor(Math.random() * 100) - 50;
                randomPeriod = currentPeriod.slice(0, -5) + (periodNum + randomOffset).toString().padStart(5, '0');
            } else {
                randomPeriod = "20250125" + Math.floor(Math.random() * 100000).toString().padStart(5, '0');
            }
            
            return {
                name: randomName,
                platform: randomPlatform,
                winAmount: randomAmount,
                account: randomAccount,
                period: randomPeriod,
                timestamp: Date.now()
            };
        }

        // Add winning proof to display
        function addWinningProofToDisplay(proof) {
            const proofsList = document.getElementById('proofsList');
            if (!proofsList) return;
            
            const proofItem = document.createElement('div');
            proofItem.className = 'proof-card';
            proofItem.innerHTML = `
                <div class="winner-header">
                    <div class="winner-name">${proof.name}</div>
                    <div class="win-amount">₹ ${proof.winAmount.toLocaleString()}</div>
                </div>
                <div class="winner-info">
                    <div class="info-row">
                        <span class="info-label">Account:</span>
                        <span class="info-value">${proof.account}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Period:</span>
                        <span class="info-value">${proof.period}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Platform:</span>
                        <span class="info-value">${proof.platform}</span>
                    </div>
                </div>
            `;
            
            proofsList.insertBefore(proofItem, proofsList.firstChild);
            
            if (proofsList.children.length > 12) {
                proofsList.removeChild(proofsList.lastChild);
            }
            
            addProofToFirebase(proof);
        }

        // Add proof to Firebase
        async function addProofToFirebase(proof) {
            try {
                if (window.firebaseDatabase) {
                    const proofsRef = window.firebaseRef(window.firebaseDatabase, 'winningProofs');
                    await window.firebasePush(proofsRef, proof);
                }
            } catch (error) {
                console.error('Error adding to Firebase:', error);
            }
        }

        // Load winning proofs from Firebase
        function loadWinningProofs() {
            try {
                if (!window.firebaseDatabase) return;
                
                const proofsRef = window.firebaseRef(window.firebaseDatabase, 'winningProofs');
                window.firebaseOnValue(proofsRef, (snapshot) => {
                    const data = snapshot.val();
                    const proofsList = document.getElementById('proofsList');
                    
                    if (!proofsList) return;
                    
                    if (data) {
                        proofsList.innerHTML = '';
                        const proofs = Object.values(data);
                        
                        proofs.sort((a, b) => b.timestamp - a.timestamp)
                             .slice(0, 6)
                             .forEach(proof => {
                                 const proofItem = document.createElement('div');
                                 proofItem.className = 'proof-card';
                                 proofItem.innerHTML = `
                                     <div class="winner-header">
                                         <div class="winner-name">${proof.name}</div>
                                         <div class="win-amount">₹ ${proof.winAmount?.toLocaleString() || '17,000'}</div>
                                     </div>
                                     <div class="winner-info">
                                         <div class="info-row">
                                             <span class="info-label">Account:</span>
                                             <span class="info-value">${proof.account || '****7890'}</span>
                                         </div>
                                         <div class="info-row">
                                             <span class="info-label">Period:</span>
                                             <span class="info-value">${proof.period || '20250125100051346'}</span>
                                         </div>
                                         <div class="info-row">
                                             <span class="info-label">Platform:</span>
                                             <span class="info-value">${proof.platform || 'TASHAN WIN'}</span>
                                         </div>
                                     </div>
                                 `;
                                 proofsList.appendChild(proofItem);
                             });
                    } else {
                        showSampleProofs();
                    }
                });
            } catch (error) {
                console.error('Error loading proofs:', error);
                showSampleProofs();
            }
        }

        // Show sample proofs
        function showSampleProofs() {
            const proofsList = document.getElementById('proofsList');
            if (!proofsList) return;
            
            proofsList.innerHTML = '';
            
            const sampleProofs = [
                { name: "Sanjay Tiwari", winAmount: 99701, account: "****0288", period: "20260114100010684", platform: "TASHAN WIN" },
                { name: "Lakshmi Rao", winAmount: 99700, account: "****3793", period: "20260114100010704", platform: "JALWA GAME" },
                { name: "Rajesh Kumar", winAmount: 85600, account: "****4567", period: "20260114100010692", platform: "91 CLUB" }
            ];
            
            sampleProofs.forEach(proof => {
                const proofItem = document.createElement('div');
                proofItem.className = 'proof-card';
                proofItem.innerHTML = `
                    <div class="winner-header">
                        <div class="winner-name">${proof.name}</div>
                        <div class="win-amount">₹ ${proof.winAmount.toLocaleString()}</div>
                    </div>
                    <div class="winner-info">
                        <div class="info-row">
                            <span class="info-label">Account:</span>
                            <span class="info-value">${proof.account}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Period:</span>
                            <span class="info-value">${proof.period}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Platform:</span>
                            <span class="info-value">${proof.platform}</span>
                        </div>
                    </div>
                `;
                proofsList.appendChild(proofItem);
            });
        }

        // UPDATED FETCH DATA FUNCTION WITH LOSS RECOVERY
        async function fetchData() {
            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                
                if (data.data && data.data.list && data.data.list.length > 0) {
                    const latest = data.data.list[0];
                    currentPeriod = latest.issueNumber;
                    lastResult = parseInt(latest.number);
                    
                    const newNumbers = data.data.list.slice(0, 10).map(item => parseInt(item.number));
                    newNumbers.reverse();
                    
                    const newTypes = newNumbers.map(num => getType(num));
                    const newColors = newNumbers.map(num => getColor(num));
                    
                    last10Numbers = newNumbers;
                    last10Types = newTypes;
                    last10Colors = newColors;
                    
                    const predictionStatus = document.getElementById('predictionStatus');
                    if (predictionStatus) {
                        predictionStatus.textContent = `Current Period: ${currentPeriod}`;
                    }
                    
                    // Check if this is a new period
                    if (currentPeriod !== lastProcessedPeriod) {
                        lastProcessedPeriod = currentPeriod;
                        
                        // Reset prediction lock for new period
                        predictionLocked = false;
                        currentPrediction = null;
                        
                        // Update the period display
                        nextPeriod = calculateNextPeriod(currentPeriod);
                        const periodNumber = document.getElementById('periodNumber');
                        if (periodNumber) {
                            periodNumber.textContent = nextPeriod;
                        }
                        
                        // Determine if we're in recovery mode
                        const isRecoveryMode = consecutiveLosses > 0;
                        
                        // Run dynamic analysis
                        const analysis = dynamicPredictionAlgorithm(newNumbers, newTypes, newColors, isRecoveryMode);
                        updateDisplayWithAnalysis(newNumbers, newTypes, newColors, analysis);
                        
                        // Switch server if needed
                        const didSwitch = switchServerIfNeeded(analysis.shouldSwitchServer);
                        
                        // Update recovery section if in recovery mode
                        if (isRecoveryMode) {
                            const recoverySection = document.getElementById('lossRecoverySection');
                            recoverySection.classList.add('active');
                            document.getElementById('consecutiveLossesCount').textContent = consecutiveLosses;
                            document.getElementById('recoveryStrategy').textContent = analysis.strategy;
                            document.getElementById('recoveryAccuracy').textContent = `${analysis.confidence}%`;
                        } else {
                            document.getElementById('lossRecoverySection').classList.remove('active');
                        }
                        
                        // Determine final prediction
                        let finalPrediction = '';
                        let displayText = '';
                        let cssClass = '';
                        
                        if (currentServer === 'color') {
                            finalPrediction = analysis.colorPrediction;
                            displayText = getColorFromCode(finalPrediction);
                            cssClass = finalPrediction === 'R' ? 'prediction-red' : 'prediction-green';
                        } else {
                            finalPrediction = analysis.sizePrediction;
                            displayText = getSizeFromType(finalPrediction);
                            cssClass = finalPrediction === 'B' ? 'prediction-big' : 'prediction-small';
                        }
                        
                        // Update prediction display
                        const predictionText = document.getElementById('predictionText');
                        if (predictionText) {
                            predictionText.textContent = displayText;
                            predictionText.className = 'prediction-value ' + cssClass;
                        }
                        
                        // Store the prediction for this period
                        predictionMadeForPeriod = nextPeriod;
                        lastPrediction = {
                            server: currentServer,
                            sizePrediction: analysis.sizePrediction,
                            colorPrediction: analysis.colorPrediction,
                            display: displayText,
                            period: currentPeriod,
                            nextPeriod: nextPeriod,
                            confidence: analysis.confidence,
                            strategy: analysis.strategy,
                            recoveryMode: isRecoveryMode
                        };
                        
                        // Store current prediction and lock it
                        currentPrediction = lastPrediction;
                        predictionLocked = true;
                        
                        isWaitingForResult = true;
                        
                        // Update performance stats
                        performanceStats.totalPredictions++;
                        
                        // Update status
                        if (predictionStatus) {
                            let statusText = `Dynamic prediction for period: ${nextPeriod}`;
                            if (isRecoveryMode) {
                                statusText += ` (Recovery Mode: ${analysis.strategy})`;
                            } else {
                                statusText += ` (${analysis.strategy} - ${analysis.confidence}% confidence)`;
                            }
                            if (didSwitch) {
                                statusText += ` - Server switched`;
                            }
                            predictionStatus.textContent = statusText;
                        }
                    } else {
                        // If we're still in the same period, keep the same prediction
                        if (predictionLocked && currentPrediction) {
                            const predictionText = document.getElementById('predictionText');
                            if (predictionText) {
                                if (predictionText.textContent !== currentPrediction.display) {
                                    predictionText.textContent = currentPrediction.display;
                                    
                                    let cssClass = '';
                                    if (currentPrediction.server === 'color') {
                                        cssClass = currentPrediction.colorPrediction === 'R' ? 'prediction-red' : 'prediction-green';
                                    } else {
                                        cssClass = currentPrediction.sizePrediction === 'B' ? 'prediction-big' : 'prediction-small';
                                    }
                                    predictionText.className = 'prediction-value ' + cssClass;
                                }
                            }
                            
                            if (predictionStatus) {
                                predictionStatus.textContent = `Awaiting result for period: ${nextPeriod}`;
                            }
                        }
                    }
                    
                    // Check if we have a pending prediction and its result is available
                    if (isWaitingForResult && predictionMadeForPeriod === currentPeriod) {
                        checkResult();
                        isWaitingForResult = false;
                    }
                    
                }
            } catch (error) {
                console.error('Error fetching data:', error);
                const predictionStatus = document.getElementById('predictionStatus');
                if (predictionStatus) {
                    predictionStatus.textContent = "Error fetching data. Retrying...";
                }
            }
        }

        // Check result against prediction
        function checkResult() {
            if (!lastPrediction || !lastResult) return;
            
            const actualType = getType(lastResult);
            const actualColor = getColor(lastResult);
            let isWin = false;
            
            if (lastPrediction.server === 'color') {
                isWin = lastPrediction.colorPrediction === actualColor;
            } else {
                isWin = lastPrediction.sizePrediction === actualType;
            }
            
            // Update server accuracy
            if (lastPrediction.server === 'color') {
                performanceStats.colorServerAccuracy = updateAccuracy(
                    performanceStats.colorServerAccuracy, 
                    isWin
                );
            } else {
                performanceStats.sizeServerAccuracy = updateAccuracy(
                    performanceStats.sizeServerAccuracy, 
                    isWin
                );
            }
            
            const winSound = document.getElementById('winSound');
            const loseSound = document.getElementById('loseSound');
            
            if (isWin) {
                consecutiveWins++;
                consecutiveLosses = 0;
                recoveryMode = false;
                
                performanceStats.correctPredictions++;
                performanceStats.currentStreak = consecutiveWins;
                performanceStats.streakType = 'win';
                
                if (winSound) {
                    winSound.currentTime = 0;
                    winSound.play();
                }
                
                // Add winning proof
                const winProof = {
                    name: indianNames[Math.floor(Math.random() * indianNames.length)],
                    platform: currentPlatform,
                    winAmount: Math.floor(Math.random() * (100000 - 200 + 1)) + 200,
                    account: "****" + Math.floor(Math.random() * 10000).toString().padStart(4, '0'),
                    period: currentPeriod,
                    timestamp: Date.now()
                };
                
                addWinningProofToDisplay(winProof);
                
                const predictionStatus = document.getElementById('predictionStatus');
                if (predictionStatus) {
                    predictionStatus.textContent = `✅ WIN! ${lastPrediction.strategy} worked for period: ${currentPeriod} (${consecutiveWins} wins streak)`;
                }
                
                // Store successful strategy
                predictionHistory.push({
                    period: currentPeriod,
                    win: true,
                    strategy: lastPrediction.strategy,
                    server: lastPrediction.server,
                    confidence: lastPrediction.confidence
                });
                
            } else {
                consecutiveLosses++;
                consecutiveWins = 0;
                
                performanceStats.currentStreak = consecutiveLosses;
                performanceStats.streakType = 'loss';
                lastLossPeriod = currentPeriod;
                recoveryMode = true;
                
                if (loseSound) {
                    loseSound.currentTime = 0;
                    loseSound.play();
                }
                
                const predictionStatus = document.getElementById('predictionStatus');
                if (predictionStatus) {
                    predictionStatus.textContent = `❌ LOSS! ${lastPrediction.strategy} failed for period: ${currentPeriod} (${consecutiveLosses} losses)`;
                    
                    if (consecutiveLosses === 1) {
                        predictionStatus.textContent += ` - Switching strategy...`;
                    } else if (consecutiveLosses >= 2) {
                        predictionStatus.textContent += ` - Aggressive recovery activated`;
                    }
                }
                
                // Store failed strategy
                predictionHistory.push({
                    period: currentPeriod,
                    win: false,
                    strategy: lastPrediction.strategy,
                    server: lastPrediction.server,
                    confidence: lastPrediction.confidence
                });
            }
            
            // Update win rate
            performanceStats.winRate = Math.round(
                (performanceStats.correctPredictions / performanceStats.totalPredictions) * 100
            ) || 75;
            
            // Update last 10 accuracy
            const last10Predictions = predictionHistory.slice(-10);
            if (last10Predictions.length > 0) {
                const last10Wins = last10Predictions.filter(p => p.win).length;
                performanceStats.last10Accuracy = Math.round((last10Wins / last10Predictions.length) * 100);
            }
            
            // Update stats display
            updateStatsDisplay();
        }

        // Update accuracy
        function updateAccuracy(currentAccuracy, isWin) {
            const adjustment = isWin ? 1 : -2;
            return Math.max(50, Math.min(95, currentAccuracy + adjustment));
        }

        // Update stats display
        function updateStatsDisplay() {
            document.getElementById('winRate').textContent = `${performanceStats.winRate}%`;
            document.getElementById('predictionAccuracy').textContent = `${performanceStats.last10Accuracy}%`;
            
            // Update trend indicator
            const winRateTrend = document.getElementById('winRateTrend');
            if (performanceStats.winRate > 75) {
                winRateTrend.textContent = `↑ ${performanceStats.winRate - 75}% today`;
                winRateTrend.style.color = '#00ff88';
            } else if (performanceStats.winRate < 75) {
                winRateTrend.textContent = `↓ ${75 - performanceStats.winRate}% today`;
                winRateTrend.style.color = '#ff3366';
            } else {
                winRateTrend.textContent = `→ Stable`;
                winRateTrend.style.color = '#ffcc00';
            }
            
            // Update win rate card
            const winRateCard = document.getElementById('winRateCard');
            if (performanceStats.winRate >= 80) {
                winRateCard.classList.add('active');
                winRateCard.classList.remove('loss');
            } else if (performanceStats.winRate <= 60) {
                winRateCard.classList.remove('active');
                winRateCard.classList.add('loss');
            } else {
                winRateCard.classList.remove('active', 'loss');
            }
            
            // Update accuracy card
            const accuracyCard = document.getElementById('accuracyCard');
            if (performanceStats.last10Accuracy >= 80) {
                accuracyCard.classList.add('active');
                accuracyCard.classList.remove('loss');
            } else if (performanceStats.last10Accuracy <= 60) {
                accuracyCard.classList.remove('active');
                accuracyCard.classList.add('loss');
            } else {
                accuracyCard.classList.remove('active', 'loss');
            }
        }

        // Start prediction system
        function startPredictionSystem() {
            // Initial fetch
            fetchData();
            
            // Fetch every 5 seconds
            fetchInterval = setInterval(fetchData, 5000);
            
            // Load initial winning proofs
            loadWinningProofs();
            
            // Start auto-generating winning proofs every 5 seconds
            if (proofInterval) {
                clearInterval(proofInterval);
            }
            
            proofInterval = setInterval(() => {
                const randomProof = generateRandomWinningProof();
                addWinningProofToDisplay(randomProof);
            }, 5000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Mickey X Web - Dynamic Prediction System Loaded');
            console.log('Features:');
            console.log('1. Dynamic strategy adjustment after losses');
            console.log('2. Real-time pattern analysis');
            console.log('3. Recovery mode for consecutive losses');
            console.log('4. Server switching based on performance');
            
            // Show landing page only
            document.getElementById('landing-page').style.display = 'block';
            document.getElementById('video-page').style.display = 'none';
            document.getElementById('access-key-page').style.display = 'none';
            document.getElementById('prediction-page').style.display = 'none';
            document.getElementById('sorry-video-page').style.display = 'none';
        });
    </script>
</body>
</html>
